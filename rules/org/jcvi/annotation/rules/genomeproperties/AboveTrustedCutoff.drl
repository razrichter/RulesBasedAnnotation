#created on: Apr 6, 2010
package org.jcvi.annotation.rules.genomeproperties
import org.jcvi.annotation.facts.*;
import java.util.ArrayList;

rule "HMM Hit above cutoff (Property exists)"
	when
		hit : HmmHit( aboveTrustedHit == true,
						hitId : hitId, queryId : queryId )
		p	: FeatureProperty( id == hitId )
		f	: Feature ( featureId == queryId, properties not contains p )
 	then
  		//System.out.println("Assign HMM FeatureProperty " + hitId + " " + p.getValue() + " on " + f.toString());
 		modify( p ) { setValue(1) };
 		modify( f ) { addProperty(p) };
end


